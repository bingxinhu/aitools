{"remainingRequest":"/home/cxhpc/workroot_lfs/goadmin/go-admin-ui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/cxhpc/workroot_lfs/goadmin/go-admin-ui/src/views/admin/sys-config/set.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/cxhpc/workroot_lfs/goadmin/go-admin-ui/src/views/admin/sys-config/set.vue","mtime":1669257735079},{"path":"/home/cxhpc/workroot_lfs/goadmin/go-admin-ui/node_modules/cache-loader/dist/cjs.js","mtime":1670489672947},{"path":"/home/cxhpc/workroot_lfs/goadmin/go-admin-ui/node_modules/babel-loader/lib/index.js","mtime":1670489673015},{"path":"/home/cxhpc/workroot_lfs/goadmin/go-admin-ui/node_modules/cache-loader/dist/cjs.js","mtime":1670489672947},{"path":"/home/cxhpc/workroot_lfs/goadmin/go-admin-ui/node_modules/vue-loader/lib/index.js","mtime":1670489672091}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7CiAgZ2V0U2V0Q29uZmlnLAogIHVwZGF0ZVNldENvbmZpZwp9IGZyb20gJ0AvYXBpL2FkbWluL3N5cy1jb25maWcnCgppbXBvcnQgeyBnZXRUb2tlbiB9IGZyb20gJ0AvdXRpbHMvYXV0aCcKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnU3lzQ29uZmlnU2V0JywKICBjb21wb25lbnRzOiB7CiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgLy8g6YGu572p5bGCCiAgICAgIGxvYWRpbmc6IHRydWUsCiAgICAgIC8vIOWPguaVsOihqOagvOaVsOaNrgogICAgICBjb25maWdMaXN0OiBbXSwKICAgICAgZm9ybUNvbmY6IHt9LAogICAgICBoZWFkZXJzOiB7ICdBdXRob3JpemF0aW9uJzogJ0JlYXJlciAnICsgZ2V0VG9rZW4oKSB9LAogICAgICBmb3JtOiB7CiAgICAgICAgc3lzX2FwcF9uYW1lOiB1bmRlZmluZWQsCiAgICAgICAgc3lzX2FwcF9sb2dvOiBudWxsLAogICAgICAgIHN5c191c2VyX2luaXRQYXNzd29yZDogdW5kZWZpbmVkLAogICAgICAgIHN5c19pbmRleF9za2luTmFtZTogdW5kZWZpbmVkLAogICAgICAgIHN5c19pbmRleF9zaWRlVGhlbWU6IHVuZGVmaW5lZAogICAgICB9LAogICAgICBydWxlczogewogICAgICAgIHN5c19hcHBfbmFtZTogW3sKICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgbWVzc2FnZTogJ+ivt+i+k+WFpeezu+e7n+WQjeensCcsCiAgICAgICAgICB0cmlnZ2VyOiAnYmx1cicKICAgICAgICB9XSwKICAgICAgICBzeXNfdXNlcl9pbml0UGFzc3dvcmQ6IFt7CiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICAgIG1lc3NhZ2U6ICfor7fovpPlhaXliJ3lp4vlr4bnoIEnLAogICAgICAgICAgdHJpZ2dlcjogJ2JsdXInCiAgICAgICAgfV0sCiAgICAgICAgc3lzX2luZGV4X3NraW5OYW1lOiBbewogICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICBtZXNzYWdlOiAn6K+36YCJ5oup55qu6IKk5qC35byPJywKICAgICAgICAgIHRyaWdnZXI6ICdjaGFuZ2UnCiAgICAgICAgfV0sCiAgICAgICAgc3lzX2luZGV4X3NpZGVUaGVtZTogW3sKICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgbWVzc2FnZTogJ+ivt+mAieaLqeS+p+agj+S4u+mimCcsCiAgICAgICAgICB0cmlnZ2VyOiAnY2hhbmdlJwogICAgICAgIH1dCiAgICAgIH0sCiAgICAgIHN5c19hcHBfbG9nb0FjdGlvbjogcHJvY2Vzcy5lbnYuVlVFX0FQUF9CQVNFX0FQSSArICcvYXBpL3YxL3B1YmxpYy91cGxvYWRGaWxlJywKICAgICAgc3lzX2FwcF9sb2dvZmlsZUxpc3Q6IFtdLAogICAgICBzeXNfaW5kZXhfc2tpbk5hbWVPcHRpb25zOiBbewogICAgICAgICdsYWJlbCc6ICfok53oibInLAogICAgICAgICd2YWx1ZSc6ICdza2luLWJsdWUnCiAgICAgIH1dLAogICAgICBzeXNfaW5kZXhfc2lkZVRoZW1lT3B0aW9uczogW3sKICAgICAgICAnbGFiZWwnOiAn5rex6Imy5Li76aKYJywKICAgICAgICAndmFsdWUnOiAndGhlbWUtZGFyaycKICAgICAgfV0KICAgIH0KICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmdldExpc3QoKQogIH0sCiAgbWV0aG9kczogewogICAgc3VibWl0Rm9ybSgpIHsKICAgICAgY29uc29sZS5sb2codGhpcy5mb3JtKQogICAgICB0aGlzLiRyZWZzWydmb3JtJ10udmFsaWRhdGUodmFsaWQgPT4gewogICAgICAgIGlmICghdmFsaWQpIHJldHVybgogICAgICAgIGNvbnNvbGUubG9nKHRoaXMuZm9ybSkKICAgICAgICB2YXIgbGlzdCA9IFtdCiAgICAgICAgdmFyIGkgPSAwCiAgICAgICAgZm9yICh2YXIga2V5IGluIHRoaXMuZm9ybSkgewogICAgICAgICAgbGlzdFtpXSA9IHsKICAgICAgICAgICAgJ2NvbmZpZ0tleSc6IGtleSwKICAgICAgICAgICAgJ2NvbmZpZ1ZhbHVlJzogdGhpcy5mb3JtW2tleV0KICAgICAgICAgIH0KICAgICAgICAgIGkrKwogICAgICAgIH0KICAgICAgICB1cGRhdGVTZXRDb25maWcobGlzdCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICBpZiAocmVzcG9uc2UuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgIHRoaXMubXNnU3VjY2VzcyhyZXNwb25zZS5tc2cpCiAgICAgICAgICAgIHRoaXMub3BlbiA9IGZhbHNlCiAgICAgICAgICAgIHRoaXMuZ2V0TGlzdCgpCiAgICAgICAgICAgIGNvbnN0IHsgc3lzX2FwcF9uYW1lLCBzeXNfYXBwX2xvZ28gfSA9IHRoaXMuZm9ybQogICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3N5c3RlbS9TRVRfSU5GTycsIHsKICAgICAgICAgICAgICBzeXNfYXBwX2xvZ28sCiAgICAgICAgICAgICAgc3lzX2FwcF9uYW1lCiAgICAgICAgICAgIH0pCiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLm1zZ0Vycm9yKHJlc3BvbnNlLm1zZykKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICB9KQogICAgfSwKICAgIHJlc2V0Rm9ybSgpIHsKICAgICAgdGhpcy4kcmVmc1snZm9ybSddLnJlc2V0RmllbGRzKCkKICAgIH0sCiAgICBzeXNfYXBwX2xvZ29CZWZvcmVVcGxvYWQoZmlsZSkgewogICAgICBjb25zdCBpc1JpZ2h0U2l6ZSA9IGZpbGUuc2l6ZSAvIDEwMjQgLyAxMDI0IDwgMgogICAgICBpZiAoIWlzUmlnaHRTaXplKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign5paH5Lu25aSn5bCP6LaF6L+HIDJNQicpCiAgICAgIH0KICAgICAgcmV0dXJuIGlzUmlnaHRTaXplCiAgICB9LAogICAgdXBsb2FkU3VjY2VzcyhyZXNwb25zZSwgZmlsZSwgZmlsZUxpc3QpIHsKICAgICAgY29uc29sZS5sb2coJ3NzcycpCiAgICAgIHRoaXMuZm9ybS5zeXNfYXBwX2xvZ28gPSBwcm9jZXNzLmVudi5WVUVfQVBQX0JBU0VfQVBJICsgcmVzcG9uc2UuZGF0YS5mdWxsX3BhdGgKICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UuZGF0YS5mdWxsX3BhdGgpCiAgICB9LAogICAgLyoqIOafpeivouWPguaVsOWIl+ihqCAqLwogICAgZ2V0TGlzdCgpIHsKICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZQogICAgICBnZXRTZXRDb25maWcoKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICB0aGlzLmNvbmZpZ0xpc3QgPSByZXNwb25zZS5kYXRhCiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2UKICAgICAgICB0aGlzLmZvcm0gPSB0aGlzLmNvbmZpZ0xpc3QKICAgICAgICAvLyB0aGlzLnN5c19hcHBfbG9nb2ZpbGVMaXN0ID0gW3RoaXMuY29uZmlnTGlzdC5zeXNfYXBwX2xvZ29dCiAgICAgICAgLy8gdGhpcy5maWxsRm9ybURhdGEodGhpcy5lbEZvcm0sIHRoaXMuY29uZmlnTGlzdCkKICAgICAgICAvLyDmm7TmlrDooajljZUKICAgICAgICAvLyB0aGlzLmtleTIgPSArbmV3IERhdGUoKQogICAgICB9KQogICAgfSwKICAgIHNldFVybCh1cmwpIHsKICAgICAgY29uc3QgZGF0YSA9IHsKICAgICAgICBzeXNfYXBwX2xvZ286ICcnCiAgICAgIH0KICAgICAgZGF0YS5zeXNfYXBwX2xvZ28gPSB1cmwKICAgICAgLy8g5Zue5aGr5pWw5o2uCiAgICAgIHRoaXMuZmlsbEZvcm1EYXRhKHRoaXMuZm9ybUNvbmYsIGRhdGEpCiAgICAgIC8vIOabtOaWsOihqOWNlQogICAgICB0aGlzLmtleTIgPSArbmV3IERhdGUoKQogICAgfSwKICAgIC8vIOWPguaVsOezu+e7n+WGhee9ruWtl+WFuOe/u+ivkQogICAgdHlwZUZvcm1hdChyb3csIGNvbHVtbikgewogICAgICByZXR1cm4gdGhpcy5zZWxlY3REaWN0TGFiZWwodGhpcy50eXBlT3B0aW9ucywgcm93LmNvbmZpZ1R5cGUpCiAgICB9LAogICAgLyoqIOaQnOe0ouaMiemSruaTjeS9nCAqLwogICAgaGFuZGxlUXVlcnkoKSB7CiAgICAgIHRoaXMucXVlcnlQYXJhbXMucGFnZUluZGV4ID0gMQogICAgICB0aGlzLmdldExpc3QoKQogICAgfSwKICAgIGZpbGxGb3JtRGF0YShmb3JtLCBkYXRhKSB7CiAgICAgIGZvcm0uZmllbGRzLmZvckVhY2goaXRlbSA9PiB7CiAgICAgICAgY29uc3QgdmFsID0gZGF0YVtpdGVtLl9fdk1vZGVsX19dCiAgICAgICAgaWYgKHZhbCkgewogICAgICAgICAgaXRlbS5fX2NvbmZpZ19fLmRlZmF1bHRWYWx1ZSA9IHZhbAogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgICBiaW5kKGtleSwgZGF0YSkgewogICAgICB0aGlzLnNldFVybChkYXRhKQogICAgfSwKICAgIHN1bWJpdEZvcm0yKGRhdGEpIHsKICAgICAgdmFyIGxpc3QgPSBbXQogICAgICB2YXIgaSA9IDAKICAgICAgZm9yICh2YXIga2V5IGluIGRhdGEpIHsKICAgICAgICBsaXN0W2ldID0gewogICAgICAgICAgJ2NvbmZpZ0tleSc6IGtleSwKICAgICAgICAgICdjb25maWdWYWx1ZSc6IGRhdGFba2V5XQogICAgICAgIH0KICAgICAgICBpKysKICAgICAgfQogICAgICB1cGRhdGVTZXRDb25maWcobGlzdCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgaWYgKHJlc3BvbnNlLmNvZGUgPT09IDIwMCkgewogICAgICAgICAgdGhpcy5tc2dTdWNjZXNzKHJlc3BvbnNlLm1zZykKICAgICAgICAgIHRoaXMub3BlbiA9IGZhbHNlCiAgICAgICAgICB0aGlzLmdldExpc3QoKQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLm1zZ0Vycm9yKHJlc3BvbnNlLm1zZykKICAgICAgICB9CiAgICAgIH0pCiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["set.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgDA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"set.vue","sourceRoot":"src/views/admin/sys-config","sourcesContent":["<template>\n  <BasicLayout>\n    <template #wrapper>\n      <el-card class=\"box-card\">\n        <el-tabs tab-position=\"left\" style=\"height: 100%;\">\n          <el-tab-pane label=\"系统内置\">\n            <el-form label-width=\"80px\">\n              <div class=\"test-form\">\n                <el-form ref=\"form\" :model=\"form\" :rules=\"rules\" size=\"small\" label-width=\"100px\">\n                  <el-form-item label=\"系统名称\" prop=\"sys_app_name\">\n                    <el-input v-model=\"form.sys_app_name\" placeholder=\"请输入系统名称\" clearable :style=\"{width: '100%'}\" />\n                  </el-form-item>\n                  <el-form-item label=\"系统logo\" prop=\"sys_app_logo\" required>\n                    <img v-if=\"form.sys_app_logo\" :src=\"form.sys_app_logo\" class=\"el-upload el-upload--picture-card\" style=\"float:left\">\n                    <el-upload ref=\"sys_app_logo\" :headers=\"headers\" :file-list=\"sys_app_logofileList\" :action=\"sys_app_logoAction\" style=\"float:left\" :before-upload=\"sys_app_logoBeforeUpload\" list-type=\"picture-card\" :show-file-list=\"false\" :on-success=\"uploadSuccess\">\n                      <i class=\"el-icon-plus\" />\n                    </el-upload>\n                  </el-form-item>\n                  <el-form-item label=\"初始密码\" prop=\"sys_user_initPassword\">\n                    <el-input v-model=\"form.sys_user_initPassword\" placeholder=\"请输入初始密码\" clearable :style=\"{width: '100%'}\" />\n                  </el-form-item>\n                  <el-form-item label=\"皮肤样式\" prop=\"sys_index_skinName\">\n                    <el-select v-model=\"form.sys_index_skinName\" placeholder=\"请选择皮肤样式\" clearable :style=\"{width: '100%'}\">\n                      <el-option v-for=\"(item, index) in sys_index_skinNameOptions\" :key=\"index\" :label=\"item.label\" :value=\"item.value\" :disabled=\"item.disabled\" />\n                    </el-select>\n                  </el-form-item>\n                  <el-form-item label=\"侧栏主题\" prop=\"sys_index_sideTheme\">\n                    <el-select v-model=\"form.sys_index_sideTheme\" placeholder=\"请选择侧栏主题\" clearable :style=\"{width: '100%'}\">\n                      <el-option v-for=\"(item, index) in sys_index_sideThemeOptions\" :key=\"index\" :label=\"item.label\" :value=\"item.value\" :disabled=\"item.disabled\" />\n                    </el-select>\n                  </el-form-item>\n                  <el-form-item size=\"large\">\n                    <el-button type=\"primary\" @click=\"submitForm\">提交</el-button>\n                    <el-button @click=\"resetForm\">重置</el-button>\n                  </el-form-item>\n                </el-form>\n              </div>\n            </el-form>\n          </el-tab-pane>\n          <el-tab-pane label=\"其他\">其他</el-tab-pane>\n        </el-tabs>\n\n      </el-card>\n    </template>\n  </BasicLayout>\n</template>\n\n<script>\nimport {\n  getSetConfig,\n  updateSetConfig\n} from '@/api/admin/sys-config'\n\nimport { getToken } from '@/utils/auth'\n\nexport default {\n  name: 'SysConfigSet',\n  components: {\n  },\n  data() {\n    return {\n      // 遮罩层\n      loading: true,\n      // 参数表格数据\n      configList: [],\n      formConf: {},\n      headers: { 'Authorization': 'Bearer ' + getToken() },\n      form: {\n        sys_app_name: undefined,\n        sys_app_logo: null,\n        sys_user_initPassword: undefined,\n        sys_index_skinName: undefined,\n        sys_index_sideTheme: undefined\n      },\n      rules: {\n        sys_app_name: [{\n          required: true,\n          message: '请输入系统名称',\n          trigger: 'blur'\n        }],\n        sys_user_initPassword: [{\n          required: true,\n          message: '请输入初始密码',\n          trigger: 'blur'\n        }],\n        sys_index_skinName: [{\n          required: true,\n          message: '请选择皮肤样式',\n          trigger: 'change'\n        }],\n        sys_index_sideTheme: [{\n          required: true,\n          message: '请选择侧栏主题',\n          trigger: 'change'\n        }]\n      },\n      sys_app_logoAction: process.env.VUE_APP_BASE_API + '/api/v1/public/uploadFile',\n      sys_app_logofileList: [],\n      sys_index_skinNameOptions: [{\n        'label': '蓝色',\n        'value': 'skin-blue'\n      }],\n      sys_index_sideThemeOptions: [{\n        'label': '深色主题',\n        'value': 'theme-dark'\n      }]\n    }\n  },\n  created() {\n    this.getList()\n  },\n  methods: {\n    submitForm() {\n      console.log(this.form)\n      this.$refs['form'].validate(valid => {\n        if (!valid) return\n        console.log(this.form)\n        var list = []\n        var i = 0\n        for (var key in this.form) {\n          list[i] = {\n            'configKey': key,\n            'configValue': this.form[key]\n          }\n          i++\n        }\n        updateSetConfig(list).then(response => {\n          if (response.code === 200) {\n            this.msgSuccess(response.msg)\n            this.open = false\n            this.getList()\n            const { sys_app_name, sys_app_logo } = this.form\n            this.$store.commit('system/SET_INFO', {\n              sys_app_logo,\n              sys_app_name\n            })\n          } else {\n            this.msgError(response.msg)\n          }\n        })\n      })\n    },\n    resetForm() {\n      this.$refs['form'].resetFields()\n    },\n    sys_app_logoBeforeUpload(file) {\n      const isRightSize = file.size / 1024 / 1024 < 2\n      if (!isRightSize) {\n        this.$message.error('文件大小超过 2MB')\n      }\n      return isRightSize\n    },\n    uploadSuccess(response, file, fileList) {\n      console.log('sss')\n      this.form.sys_app_logo = process.env.VUE_APP_BASE_API + response.data.full_path\n      console.log(response.data.full_path)\n    },\n    /** 查询参数列表 */\n    getList() {\n      this.loading = true\n      getSetConfig().then(response => {\n        this.configList = response.data\n        this.loading = false\n        this.form = this.configList\n        // this.sys_app_logofileList = [this.configList.sys_app_logo]\n        // this.fillFormData(this.elForm, this.configList)\n        // 更新表单\n        // this.key2 = +new Date()\n      })\n    },\n    setUrl(url) {\n      const data = {\n        sys_app_logo: ''\n      }\n      data.sys_app_logo = url\n      // 回填数据\n      this.fillFormData(this.formConf, data)\n      // 更新表单\n      this.key2 = +new Date()\n    },\n    // 参数系统内置字典翻译\n    typeFormat(row, column) {\n      return this.selectDictLabel(this.typeOptions, row.configType)\n    },\n    /** 搜索按钮操作 */\n    handleQuery() {\n      this.queryParams.pageIndex = 1\n      this.getList()\n    },\n    fillFormData(form, data) {\n      form.fields.forEach(item => {\n        const val = data[item.__vModel__]\n        if (val) {\n          item.__config__.defaultValue = val\n        }\n      })\n    },\n    bind(key, data) {\n      this.setUrl(data)\n    },\n    sumbitForm2(data) {\n      var list = []\n      var i = 0\n      for (var key in data) {\n        list[i] = {\n          'configKey': key,\n          'configValue': data[key]\n        }\n        i++\n      }\n      updateSetConfig(list).then(response => {\n        if (response.code === 200) {\n          this.msgSuccess(response.msg)\n          this.open = false\n          this.getList()\n        } else {\n          this.msgError(response.msg)\n        }\n      })\n    }\n  }\n}\n</script>\n"]}]}