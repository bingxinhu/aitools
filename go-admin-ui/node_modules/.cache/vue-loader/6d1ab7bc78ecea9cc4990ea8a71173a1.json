{"remainingRequest":"/home/cxhpc/workroot_lfs/goadmin/go-admin-ui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/cxhpc/workroot_lfs/goadmin/go-admin-ui/src/views/admin/sys-dept/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/cxhpc/workroot_lfs/goadmin/go-admin-ui/src/views/admin/sys-dept/index.vue","mtime":1669257735079},{"path":"/home/cxhpc/workroot_lfs/goadmin/go-admin-ui/node_modules/cache-loader/dist/cjs.js","mtime":1670489672947},{"path":"/home/cxhpc/workroot_lfs/goadmin/go-admin-ui/node_modules/babel-loader/lib/index.js","mtime":1670489673015},{"path":"/home/cxhpc/workroot_lfs/goadmin/go-admin-ui/node_modules/cache-loader/dist/cjs.js","mtime":1670489672947},{"path":"/home/cxhpc/workroot_lfs/goadmin/go-admin-ui/node_modules/vue-loader/lib/index.js","mtime":1670489672091}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGdldERlcHRMaXN0LCBnZXREZXB0LCBkZWxEZXB0LCBhZGREZXB0LCB1cGRhdGVEZXB0IH0gZnJvbSAnQC9hcGkvYWRtaW4vc3lzLWRlcHQnCmltcG9ydCBUcmVlc2VsZWN0IGZyb20gJ0ByaW9waGFlL3Z1ZS10cmVlc2VsZWN0JwppbXBvcnQgJ0ByaW9waGFlL3Z1ZS10cmVlc2VsZWN0L2Rpc3QvdnVlLXRyZWVzZWxlY3QuY3NzJwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdTeXNEZXB0TWFuYWdlJywKICBjb21wb25lbnRzOiB7IFRyZWVzZWxlY3QgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgLy8g6YGu572p5bGCCiAgICAgIGxvYWRpbmc6IHRydWUsCiAgICAgIC8vIOihqOagvOagkeaVsOaNrgogICAgICBkZXB0TGlzdDogW10sCiAgICAgIC8vIOmDqOmXqOagkemAiemhuQogICAgICBkZXB0T3B0aW9uczogW10sCiAgICAgIC8vIOW8ueWHuuWxguagh+mimAogICAgICB0aXRsZTogJycsCiAgICAgIGlzRWRpdDogZmFsc2UsCiAgICAgIC8vIOaYr+WQpuaYvuekuuW8ueWHuuWxggogICAgICBvcGVuOiBmYWxzZSwKICAgICAgLy8g54q25oCB5pWw5o2u5a2X5YW4CiAgICAgIHN0YXR1c09wdGlvbnM6IFtdLAogICAgICAvLyDmn6Xor6Llj4LmlbAKICAgICAgcXVlcnlQYXJhbXM6IHsKICAgICAgICBkZXB0TmFtZTogdW5kZWZpbmVkLAogICAgICAgIHN0YXR1czogdW5kZWZpbmVkCiAgICAgIH0sCiAgICAgIC8vIOihqOWNleWPguaVsAogICAgICBmb3JtOiB7CiAgICAgIH0sCiAgICAgIC8vIOihqOWNleagoemqjAogICAgICBydWxlczogewogICAgICAgIHBhcmVudElkOiBbCiAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn5LiK57qn6YOo6Zeo5LiN6IO95Li656m6JywgdHJpZ2dlcjogJ2JsdXInIH0KICAgICAgICBdLAogICAgICAgIGRlcHROYW1lOiBbCiAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6YOo6Zeo5ZCN56ew5LiN6IO95Li656m6JywgdHJpZ2dlcjogJ2JsdXInIH0KICAgICAgICBdLAogICAgICAgIHNvcnQ6IFsKICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfoj5zljZXpobrluo/kuI3og73kuLrnqbonLCB0cmlnZ2VyOiAnYmx1cicgfQogICAgICAgIF0sCiAgICAgICAgbGVhZGVyOiBbCiAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6LSf6LSj5Lq65LiN6IO95Li656m6JywgdHJpZ2dlcjogJ2JsdXInIH0KICAgICAgICBdLAogICAgICAgIGVtYWlsOiBbCiAgICAgICAgICB7CiAgICAgICAgICAgIHR5cGU6ICdlbWFpbCcsCiAgICAgICAgICAgIG1lc3NhZ2U6ICIn6K+36L6T5YWl5q2j56Gu55qE6YKu566x5Zyw5Z2AIiwKICAgICAgICAgICAgdHJpZ2dlcjogWydibHVyJywgJ2NoYW5nZSddCiAgICAgICAgICB9CiAgICAgICAgXSwKICAgICAgICBwaG9uZTogWwogICAgICAgICAgewogICAgICAgICAgICBwYXR0ZXJuOiAvXjFbM3w0fDV8Nnw3fDh8OV1bMC05XVxkezh9JC8sCiAgICAgICAgICAgIG1lc3NhZ2U6ICfor7fovpPlhaXmraPnoa7nmoTmiYvmnLrlj7fnoIEnLAogICAgICAgICAgICB0cmlnZ2VyOiAnYmx1cicKICAgICAgICAgIH0KICAgICAgICBdCiAgICAgIH0KICAgIH0KICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmdldExpc3QoKQogICAgdGhpcy5nZXREaWN0cygnc3lzX25vcm1hbF9kaXNhYmxlJykudGhlbihyZXNwb25zZSA9PiB7CiAgICAgIHRoaXMuc3RhdHVzT3B0aW9ucyA9IHJlc3BvbnNlLmRhdGEKICAgIH0pCiAgfSwKICBtZXRob2RzOiB7CiAgICAvKiog5p+l6K+i6YOo6Zeo5YiX6KGoICovCiAgICBnZXRMaXN0KCkgewogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlCiAgICAgIGdldERlcHRMaXN0KHRoaXMucXVlcnlQYXJhbXMpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIHRoaXMuZGVwdExpc3QgPSByZXNwb25zZS5kYXRhCiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2UKICAgICAgfSkKICAgIH0sCiAgICAvKiog6L2s5o2i6YOo6Zeo5pWw5o2u57uT5p6EICovCiAgICBub3JtYWxpemVyKG5vZGUpIHsKICAgICAgaWYgKG5vZGUuY2hpbGRyZW4gJiYgIW5vZGUuY2hpbGRyZW4ubGVuZ3RoKSB7CiAgICAgICAgZGVsZXRlIG5vZGUuY2hpbGRyZW4KICAgICAgfQogICAgICByZXR1cm4gewogICAgICAgIGlkOiBub2RlLmRlcHRJZCwKICAgICAgICBsYWJlbDogbm9kZS5kZXB0TmFtZSwKICAgICAgICBjaGlsZHJlbjogbm9kZS5jaGlsZHJlbgogICAgICB9CiAgICB9LAogICAgLyoqIOafpeivoumDqOmXqOS4i+aLieagkee7k+aehCAqLwogICAgZ2V0VHJlZXNlbGVjdChlKSB7CiAgICAgIGdldERlcHRMaXN0KCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgdGhpcy5kZXB0T3B0aW9ucyA9IFtdCgogICAgICAgIGlmIChlID09PSAndXBkYXRlJykgewogICAgICAgICAgY29uc3QgZGVwdCA9IHsgZGVwdElkOiAwLCBkZXB0TmFtZTogJ+S4u+exu+ebricsIGNoaWxkcmVuOiBbXSwgaXNEaXNhYmxlZDogdHJ1ZSB9CiAgICAgICAgICBkZXB0LmNoaWxkcmVuID0gcmVzcG9uc2UuZGF0YQogICAgICAgICAgdGhpcy5kZXB0T3B0aW9ucy5wdXNoKGRlcHQpCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnN0IGRlcHQgPSB7IGRlcHRJZDogMCwgZGVwdE5hbWU6ICfkuLvnsbvnm64nLCBjaGlsZHJlbjogW10gfQogICAgICAgICAgZGVwdC5jaGlsZHJlbiA9IHJlc3BvbnNlLmRhdGEKICAgICAgICAgIHRoaXMuZGVwdE9wdGlvbnMucHVzaChkZXB0KQogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgICAvLyDlrZflhbjnirbmgIHlrZflhbjnv7vor5EKICAgIHN0YXR1c0Zvcm1hdChyb3cpIHsKICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0RGljdExhYmVsKHRoaXMuc3RhdHVzT3B0aW9ucywgcGFyc2VJbnQocm93LnN0YXR1cykpCiAgICB9LAogICAgLy8g5Y+W5raI5oyJ6ZKuCiAgICBjYW5jZWwoKSB7CiAgICAgIHRoaXMub3BlbiA9IGZhbHNlCiAgICAgIHRoaXMucmVzZXQoKQogICAgfSwKICAgIC8vIOihqOWNlemHjee9rgogICAgcmVzZXQoKSB7CiAgICAgIHRoaXMuZm9ybSA9IHsKICAgICAgICBkZXB0SWQ6IHVuZGVmaW5lZCwKICAgICAgICBwYXJlbnRJZDogdW5kZWZpbmVkLAogICAgICAgIGRlcHROYW1lOiB1bmRlZmluZWQsCiAgICAgICAgc29ydDogMTAsCiAgICAgICAgbGVhZGVyOiB1bmRlZmluZWQsCiAgICAgICAgcGhvbmU6IHVuZGVmaW5lZCwKICAgICAgICBlbWFpbDogdW5kZWZpbmVkLAogICAgICAgIHN0YXR1czogJzInCiAgICAgIH0KICAgIH0sCiAgICAvKiog5pCc57Si5oyJ6ZKu5pON5L2cICovCiAgICBoYW5kbGVRdWVyeSgpIHsKICAgICAgdGhpcy5nZXRMaXN0KCkKICAgIH0sCiAgICAvKiog5paw5aKe5oyJ6ZKu5pON5L2cICovCiAgICBoYW5kbGVBZGQocm93KSB7CiAgICAgIHRoaXMucmVzZXQoKQogICAgICB0aGlzLmdldFRyZWVzZWxlY3QoJ2FkZCcpCiAgICAgIGlmIChyb3cgIT09IHVuZGVmaW5lZCkgewogICAgICAgIHRoaXMuZm9ybS5wYXJlbnRJZCA9IHJvdy5kZXB0SWQKICAgICAgfQogICAgICB0aGlzLm9wZW4gPSB0cnVlCiAgICAgIHRoaXMudGl0bGUgPSAn5re75Yqg6YOo6ZeoJwogICAgICB0aGlzLmlzRWRpdCA9IGZhbHNlCiAgICB9LAogICAgLyoqIOS/ruaUueaMiemSruaTjeS9nCAqLwogICAgaGFuZGxlVXBkYXRlKHJvdykgewogICAgICB0aGlzLnJlc2V0KCkKICAgICAgdGhpcy5nZXRUcmVlc2VsZWN0KCd1cGRhdGUnKQoKICAgICAgZ2V0RGVwdChyb3cuZGVwdElkKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICB0aGlzLmZvcm0gPSByZXNwb25zZS5kYXRhCiAgICAgICAgdGhpcy5mb3JtLnN0YXR1cyA9IFN0cmluZyh0aGlzLmZvcm0uc3RhdHVzKQogICAgICAgIHRoaXMuZm9ybS5zb3J0ID0gU3RyaW5nKHRoaXMuZm9ybS5zb3J0KQogICAgICAgIHRoaXMub3BlbiA9IHRydWUKICAgICAgICB0aGlzLnRpdGxlID0gJ+S/ruaUuemDqOmXqCcKICAgICAgICB0aGlzLmlzRWRpdCA9IHRydWUKICAgICAgfSkKICAgIH0sCiAgICAvKiog5o+Q5Lqk5oyJ6ZKuICovCiAgICBzdWJtaXRGb3JtOiBmdW5jdGlvbigpIHsKICAgICAgdGhpcy4kcmVmc1snZm9ybSddLnZhbGlkYXRlKHZhbGlkID0+IHsKICAgICAgICBpZiAodmFsaWQpIHsKICAgICAgICAgIHRoaXMuZm9ybS5zdGF0dXMgPSBwYXJzZUludCh0aGlzLmZvcm0uc3RhdHVzKQogICAgICAgICAgdGhpcy5mb3JtLnNvcnQgPSBwYXJzZUludCh0aGlzLmZvcm0uc29ydCkKICAgICAgICAgIGlmICh0aGlzLmZvcm0uZGVwdElkICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgdXBkYXRlRGVwdCh0aGlzLmZvcm0sIHRoaXMuZm9ybS5kZXB0SWQpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgICAgICAgIGlmIChyZXNwb25zZS5jb2RlID09PSAyMDApIHsKICAgICAgICAgICAgICAgIHRoaXMubXNnU3VjY2VzcyhyZXNwb25zZS5tc2cpCiAgICAgICAgICAgICAgICB0aGlzLm9wZW4gPSBmYWxzZQogICAgICAgICAgICAgICAgdGhpcy5nZXRMaXN0KCkKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdGhpcy5tc2dFcnJvcihyZXNwb25zZS5tc2cpCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgYWRkRGVwdCh0aGlzLmZvcm0pLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgICAgICAgIGlmIChyZXNwb25zZS5jb2RlID09PSAyMDApIHsKICAgICAgICAgICAgICAgIHRoaXMubXNnU3VjY2VzcyhyZXNwb25zZS5tc2cpCiAgICAgICAgICAgICAgICB0aGlzLm9wZW4gPSBmYWxzZQogICAgICAgICAgICAgICAgdGhpcy5nZXRMaXN0KCkKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdGhpcy5tc2dFcnJvcihyZXNwb25zZS5tc2cpCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgICAvKiog5Yig6Zmk5oyJ6ZKu5pON5L2cICovCiAgICBoYW5kbGVEZWxldGUocm93KSB7CiAgICAgIGNvbnN0IElkcyA9IChyb3cuZGVwdElkICYmIFtyb3cuZGVwdElkXSkgfHwgdGhpcy5pZHMKICAgICAgdGhpcy4kY29uZmlybSgKICAgICAgICAn5piv5ZCm56Gu6K6k5Yig6Zmk5ZCN56ew5Li6IicgKyByb3cuZGVwdE5hbWUgKyAnIueahOaVsOaNrumhuT8nLAogICAgICAgICforablkYonLAogICAgICAgIHsKICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn56Gu5a6aJywKICAgICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICflj5bmtognLAogICAgICAgICAgdHlwZTogJ3dhcm5pbmcnCiAgICAgICAgfQogICAgICApCiAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7CiAgICAgICAgICByZXR1cm4gZGVsRGVwdCh7ICdpZHMnOiBJZHMgfSkKICAgICAgICB9KS50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgaWYgKHJlc3BvbnNlLmNvZGUgPT09IDIwMCkgewogICAgICAgICAgICB0aGlzLm1zZ1N1Y2Nlc3MocmVzcG9uc2UubXNnKQogICAgICAgICAgICB0aGlzLm9wZW4gPSBmYWxzZQogICAgICAgICAgICB0aGlzLmdldExpc3QoKQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy5tc2dFcnJvcihyZXNwb25zZS5tc2cpCiAgICAgICAgICB9CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oKSB7fSkKICAgIH0KICB9Cn0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+JA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/admin/sys-dept","sourcesContent":["<template>\n  <BasicLayout>\n    <template #wrapper>\n      <el-card class=\"box-card\">\n        <el-form :inline=\"true\">\n          <el-form-item label=\"部门名称\">\n            <el-input\n              v-model=\"queryParams.deptName\"\n              placeholder=\"请输入部门名称\"\n              clearable\n              size=\"small\"\n              @keyup.enter.native=\"handleQuery\"\n            />\n          </el-form-item>\n          <el-form-item label=\"状态\">\n            <el-select v-model=\"queryParams.status\" placeholder=\"部门状态\" clearable size=\"small\">\n              <el-option\n                v-for=\"dict in statusOptions\"\n                :key=\"dict.value\"\n                :label=\"dict.label\"\n                :value=\"dict.value\"\n              />\n            </el-select>\n          </el-form-item>\n          <el-form-item>\n            <el-button\n              class=\"filter-item\"\n              type=\"primary\"\n              icon=\"el-icon-search\"\n              size=\"mini\"\n              @click=\"handleQuery\"\n            >搜索</el-button>\n            <el-button\n              v-permisaction=\"['admin:sysDept:add']\"\n              class=\"filter-item\"\n              type=\"primary\"\n              icon=\"el-icon-plus\"\n              size=\"mini\"\n              @click=\"handleAdd\"\n            >新增</el-button>\n          </el-form-item>\n        </el-form>\n\n        <el-table\n          v-loading=\"loading\"\n          :data=\"deptList\"\n          row-key=\"deptId\"\n          default-expand-all\n          border\n          :tree-props=\"{children: 'children', hasChildren: 'hasChildren'}\"\n        >\n          <el-table-column prop=\"deptName\" label=\"部门名称\" />\n          <el-table-column prop=\"sort\" label=\"排序\" width=\"200\" />\n          <el-table-column prop=\"status\" label=\"状态\" :formatter=\"statusFormat\" width=\"100\">\n            <template slot-scope=\"scope\">\n              <el-tag\n                :type=\"scope.row.status === 1 ? 'danger' : 'success'\"\n                disable-transitions\n              >{{ statusFormat(scope.row) }}</el-tag>\n            </template>\n          </el-table-column>\n          <el-table-column label=\"创建时间\" align=\"center\" prop=\"createdAt\" width=\"200\">\n            <template slot-scope=\"scope\">\n              <span>{{ parseTime(scope.row.createdAt) }}</span>\n            </template>\n          </el-table-column>\n          <el-table-column label=\"操作\" align=\"center\" class-name=\"small-padding fixed-width\">\n            <template slot-scope=\"scope\">\n              <el-button\n                v-permisaction=\"['admin:sysDept:edit']\"\n                size=\"mini\"\n                type=\"text\"\n                icon=\"el-icon-edit\"\n                @click=\"handleUpdate(scope.row)\"\n              >修改</el-button>\n              <el-button\n                v-permisaction=\"['admin:sysDept:add']\"\n                size=\"mini\"\n                type=\"text\"\n                icon=\"el-icon-plus\"\n                @click=\"handleAdd(scope.row)\"\n              >新增</el-button>\n              <el-button\n                v-if=\"scope.row.p_id != 0\"\n                v-permisaction=\"['admin:sysDept:remove']\"\n                size=\"mini\"\n                type=\"text\"\n                icon=\"el-icon-delete\"\n                @click=\"handleDelete(scope.row)\"\n              >删除</el-button>\n            </template>\n          </el-table-column>\n        </el-table>\n\n        <!-- 添加或修改部门对话框 -->\n        <el-dialog :title=\"title\" :visible.sync=\"open\" width=\"600px\" :close-on-click-modal=\"false\">\n          <el-form ref=\"form\" :model=\"form\" :rules=\"rules\" label-width=\"80px\">\n            <el-row>\n              <el-col :span=\"24\">\n                <el-form-item label=\"上级部门\" prop=\"parentId\">\n                  <treeselect\n                    v-model=\"form.parentId\"\n                    :options=\"deptOptions\"\n                    :normalizer=\"normalizer\"\n                    :show-count=\"true\"\n                    placeholder=\"选择上级部门\"\n                    :is-disabled=\"isEdit\"\n                  />\n                </el-form-item>\n              </el-col>\n              <el-col :span=\"12\">\n                <el-form-item label=\"部门名称\" prop=\"deptName\">\n                  <el-input v-model=\"form.deptName\" placeholder=\"请输入部门名称\" />\n                </el-form-item>\n              </el-col>\n              <el-col :span=\"12\">\n                <el-form-item label=\"显示排序\" prop=\"orderNum\">\n                  <el-input-number v-model=\"form.sort\" controls-position=\"right\" :min=\"0\" />\n                </el-form-item>\n              </el-col>\n              <el-col :span=\"12\">\n                <el-form-item label=\"负责人\" prop=\"leader\">\n                  <el-input v-model=\"form.leader\" placeholder=\"请输入负责人\" maxlength=\"20\" />\n                </el-form-item>\n              </el-col>\n              <el-col :span=\"12\">\n                <el-form-item label=\"联系电话\" prop=\"phone\">\n                  <el-input v-model=\"form.phone\" placeholder=\"请输入联系电话\" maxlength=\"11\" />\n                </el-form-item>\n              </el-col>\n              <el-col :span=\"12\">\n                <el-form-item label=\"邮箱\" prop=\"email\">\n                  <el-input v-model=\"form.email\" placeholder=\"请输入邮箱\" maxlength=\"50\" />\n                </el-form-item>\n              </el-col>\n              <el-col :span=\"12\">\n                <el-form-item label=\"部门状态\">\n                  <el-radio-group v-model=\"form.status\">\n                    <el-radio\n                      v-for=\"dict in statusOptions\"\n                      :key=\"dict.value\"\n                      :label=\"dict.value\"\n                    >{{ dict.label }}</el-radio>\n                  </el-radio-group>\n                </el-form-item>\n              </el-col>\n            </el-row>\n          </el-form>\n          <div slot=\"footer\" class=\"dialog-footer\">\n            <el-button type=\"primary\" @click=\"submitForm\">确 定</el-button>\n            <el-button @click=\"cancel\">取 消</el-button>\n          </div>\n        </el-dialog>\n      </el-card>\n    </template>\n  </BasicLayout>\n</template>\n\n<script>\nimport { getDeptList, getDept, delDept, addDept, updateDept } from '@/api/admin/sys-dept'\nimport Treeselect from '@riophae/vue-treeselect'\nimport '@riophae/vue-treeselect/dist/vue-treeselect.css'\n\nexport default {\n  name: 'SysDeptManage',\n  components: { Treeselect },\n  data() {\n    return {\n      // 遮罩层\n      loading: true,\n      // 表格树数据\n      deptList: [],\n      // 部门树选项\n      deptOptions: [],\n      // 弹出层标题\n      title: '',\n      isEdit: false,\n      // 是否显示弹出层\n      open: false,\n      // 状态数据字典\n      statusOptions: [],\n      // 查询参数\n      queryParams: {\n        deptName: undefined,\n        status: undefined\n      },\n      // 表单参数\n      form: {\n      },\n      // 表单校验\n      rules: {\n        parentId: [\n          { required: true, message: '上级部门不能为空', trigger: 'blur' }\n        ],\n        deptName: [\n          { required: true, message: '部门名称不能为空', trigger: 'blur' }\n        ],\n        sort: [\n          { required: true, message: '菜单顺序不能为空', trigger: 'blur' }\n        ],\n        leader: [\n          { required: true, message: '负责人不能为空', trigger: 'blur' }\n        ],\n        email: [\n          {\n            type: 'email',\n            message: \"'请输入正确的邮箱地址\",\n            trigger: ['blur', 'change']\n          }\n        ],\n        phone: [\n          {\n            pattern: /^1[3|4|5|6|7|8|9][0-9]\\d{8}$/,\n            message: '请输入正确的手机号码',\n            trigger: 'blur'\n          }\n        ]\n      }\n    }\n  },\n  created() {\n    this.getList()\n    this.getDicts('sys_normal_disable').then(response => {\n      this.statusOptions = response.data\n    })\n  },\n  methods: {\n    /** 查询部门列表 */\n    getList() {\n      this.loading = true\n      getDeptList(this.queryParams).then(response => {\n        this.deptList = response.data\n        this.loading = false\n      })\n    },\n    /** 转换部门数据结构 */\n    normalizer(node) {\n      if (node.children && !node.children.length) {\n        delete node.children\n      }\n      return {\n        id: node.deptId,\n        label: node.deptName,\n        children: node.children\n      }\n    },\n    /** 查询部门下拉树结构 */\n    getTreeselect(e) {\n      getDeptList().then(response => {\n        this.deptOptions = []\n\n        if (e === 'update') {\n          const dept = { deptId: 0, deptName: '主类目', children: [], isDisabled: true }\n          dept.children = response.data\n          this.deptOptions.push(dept)\n        } else {\n          const dept = { deptId: 0, deptName: '主类目', children: [] }\n          dept.children = response.data\n          this.deptOptions.push(dept)\n        }\n      })\n    },\n    // 字典状态字典翻译\n    statusFormat(row) {\n      return this.selectDictLabel(this.statusOptions, parseInt(row.status))\n    },\n    // 取消按钮\n    cancel() {\n      this.open = false\n      this.reset()\n    },\n    // 表单重置\n    reset() {\n      this.form = {\n        deptId: undefined,\n        parentId: undefined,\n        deptName: undefined,\n        sort: 10,\n        leader: undefined,\n        phone: undefined,\n        email: undefined,\n        status: '2'\n      }\n    },\n    /** 搜索按钮操作 */\n    handleQuery() {\n      this.getList()\n    },\n    /** 新增按钮操作 */\n    handleAdd(row) {\n      this.reset()\n      this.getTreeselect('add')\n      if (row !== undefined) {\n        this.form.parentId = row.deptId\n      }\n      this.open = true\n      this.title = '添加部门'\n      this.isEdit = false\n    },\n    /** 修改按钮操作 */\n    handleUpdate(row) {\n      this.reset()\n      this.getTreeselect('update')\n\n      getDept(row.deptId).then(response => {\n        this.form = response.data\n        this.form.status = String(this.form.status)\n        this.form.sort = String(this.form.sort)\n        this.open = true\n        this.title = '修改部门'\n        this.isEdit = true\n      })\n    },\n    /** 提交按钮 */\n    submitForm: function() {\n      this.$refs['form'].validate(valid => {\n        if (valid) {\n          this.form.status = parseInt(this.form.status)\n          this.form.sort = parseInt(this.form.sort)\n          if (this.form.deptId !== undefined) {\n            updateDept(this.form, this.form.deptId).then(response => {\n              if (response.code === 200) {\n                this.msgSuccess(response.msg)\n                this.open = false\n                this.getList()\n              } else {\n                this.msgError(response.msg)\n              }\n            })\n          } else {\n            addDept(this.form).then(response => {\n              if (response.code === 200) {\n                this.msgSuccess(response.msg)\n                this.open = false\n                this.getList()\n              } else {\n                this.msgError(response.msg)\n              }\n            })\n          }\n        }\n      })\n    },\n    /** 删除按钮操作 */\n    handleDelete(row) {\n      const Ids = (row.deptId && [row.deptId]) || this.ids\n      this.$confirm(\n        '是否确认删除名称为\"' + row.deptName + '\"的数据项?',\n        '警告',\n        {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }\n      )\n        .then(function() {\n          return delDept({ 'ids': Ids })\n        }).then((response) => {\n          if (response.code === 200) {\n            this.msgSuccess(response.msg)\n            this.open = false\n            this.getList()\n          } else {\n            this.msgError(response.msg)\n          }\n        }).catch(function() {})\n    }\n  }\n}\n</script>\n"]}]}